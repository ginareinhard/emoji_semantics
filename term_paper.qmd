---
title: "Term paper"
subtitle: ""
author: "Rose Hörsting & Gina Reinhard"
date: "2024-09-15"
engine: knitr
bibliography: references.bib
format: 
  html:
    toc: true
    embed-resources: true
link-citations: true
csl: "apa_7th.csl"
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

```

```{r}

setwd(here::here())

```

```{r include=FALSE}

library(checkdown)

```

#### **Chapter overview** {.unnumbered}

```{r load-libraries, message=FALSE}

library(here)
library(tidyverse)

```

## Introducing the study

```{r import-data, message=FALSE}

raw_data <- read_csv(file = "data/raw_data.csv")

```

## Descriptive statistics

```{r clean-data}

data <- raw_data |> 
  filter(age <= 35)

```

```{r, results=FALSE}

table(raw_data$gender)
table(raw_data$emoji_understanding)
table(raw_data$emoji_use)

```

```{r gender-count, results=FALSE}

gender_count <- data |> 
  group_by(submission_id) |> 
  count(gender)

table(gender_count$gender)

```

```{r emojiuse-count, results=FALSE}

emoji_use_count <- data |> 
  group_by(submission_id) |> 
  count(emoji_use)

table(emoji_use_count$emoji_use)

emoji_use_count_gender <- data |> 
  group_by(submission_id, gender) |> 
  count(emoji_use)

table(emoji_use_count_gender$emoji_use, emoji_use_count_gender$gender)

```

## Data wrangling / visualisation

### Walkthrough bar plot

Plot emoji use frequencies as barplot with ggplot (absolute frequencies instead of percentages):

```{r}

ggplot(emoji_use_count_gender, mapping = aes(x = emoji_use)) + 
  geom_bar()

```

Reorder levels of factor "emoji_use":

```{r plot-emojiuse}

emoji_use_count_gender <- emoji_use_count_gender |> 
  mutate(emoji_use = factor(emoji_use, levels = c("nie", "selten", "gelegentlich", "oft", "in fast jeder Nachricht")))

```

Plot with ordered levels:

```{r}

ggplot(emoji_use_count_gender, mapping = aes(x = emoji_use)) + 
  geom_bar()

```

Add title and labels:

```{r}
ggplot(emoji_use_count_gender, mapping = aes(x = emoji_use)) + 
  geom_bar() +
  labs(title = "Emoji use with absolute frequencies", x = "Emoji use", y = "Total count")
```

Bring in gender to see the difference between female and male participants in emoji use:

```{r}

ggplot(emoji_use_count_gender, mapping = aes(x = emoji_use, fill = gender)) + 
  geom_bar() +
  labs(title = "Emoji use by gender with absolute frequencies", x = "Emoji use by gender", y = "Total count")
  
```

If we do not want the bars to be stacked on top of each other, we can change that by adding the argument position = "dodge" to the geom_bar function.

```{r}

emoji_use_count_gender |> 
  ggplot(mapping = aes(x = emoji_use, fill = gender)) + 
  geom_bar(position = "dodge") +
  labs(title = "Emoji use by gender with absolute frequencies", x = "Emoji use by gender", y = "Total count")

#emoji_use_count_gender |> 
#  ggplot(mapping = aes(x = emoji_use, fill = gender)) + 
#  geom_bar(width = 0.8, position = "dodge")

```

It´s weird that the bars differ in width/ the width seems to be measured overall regardless of whether there are three bars or only one.
include divers genders?

::: callout-tip
#### Quiz time! {.unnumbered}

1\) Test question?

```{r echo=FALSE, results="asis"}

check_question("D", options = c("A", "B", "C", "D", "E"), type = "radio", 
random_answer_order = TRUE,
button_label = "Check answer", q_id = 4,
right = "Test right!",
wrong = "Test incorrect.")

```
:::

## Conclusion
