---
title: "Term paper"
subtitle: ""
author: "Rose H√∂rsting & Gina Reinhard"
date: "2024-09-15"
engine: knitr
bibliography: references.bib
format: 
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    embed-resources: true
link-citations: true
csl: "apa_7th.csl"
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

```

```{r include=FALSE}

library(checkdown)

```

#### **Chapter overview** {.unnumbered}

In this chapter, we...

```{r load-libraries, message=FALSE}

library(here)
library(tidyverse)

```

## Introducing the study

@fricke2024semantic

::: {.callout-note title="How did the experiment work?"}
...

They used the face emoji annotation system developed by @fugate2021implications.
Goal: Test the predictions of the pictorial approach. 

Pictorial approach @maier2023emojis vs. lexicalist approach @grosz2023semantics.

Question: Do AU differences lead to differences in meaning between the two emojis of a pair?
Hypothesis: "Small visual differences that do not correspond to AU differences ((no clear real-life counterparts)) should be semantically less relevant than visual differences that do correspond to AU differences" (4)
Method: three [AU+] and three [AU] emoji pairs, rendered in WhatsApp Android version; each emoji to occur on one pair; no emojis with symbolic components (5)

:::

```{r import-data, message=FALSE}

raw_data <- read.csv(file = here("data", "raw_data.csv"))

```

## Descriptive statistics

```{r clean-data}

data <- raw_data |> 
  filter(age <= 35)

```

```{r, results=FALSE}

table(raw_data$gender)
table(raw_data$emoji_understanding)
table(raw_data$emoji_use)

```

```{r gender-count, results=FALSE}

gender_count <- data |> 
  group_by(submission_id) |> 
  count(gender)

table(gender_count$gender)

```

```{r emojiuse-count, results=FALSE}

emoji_use_count <- data |> 
  group_by(submission_id) |> 
  count(emoji_use)

table(emoji_use_count$emoji_use)

```

## Data wrangling / visualisation

### Walkthrough bar plot

Plot emoji use frequencies as barplot with ggplot:

```{r}

ggplot(emoji_use_count, mapping = aes(x = emoji_use)) + 
  geom_bar()

```

Reorder levels of factor "emoji_use":

```{r plot-emojiuse}

emoji_use_count <- emoji_use_count |> 
  mutate(emoji_use = factor(emoji_use, levels = c("nie", "selten", "gelegentlich", "oft", "in fast jeder Nachricht")))

```

Plot with ordered levels:

```{r}

ggplot(emoji_use_count, mapping = aes(x = emoji_use)) + 
  geom_bar()

```

```{r emoji understanding}

emoji_understanding_percentage <- data |> 
  group_by(emoji_understanding) |> 
  summarise(count = n())%>% 
  mutate(percentage = count/sum(count))

emoji_understanding_percentage |>
  ggplot(aes(x = emoji_understanding, y = percentage, fill  =  emoji_understanding)) + 
  geom_bar(stat = "identity") +
labs(x = "self-reported emoji understanding")

# The following is copied from Fricke et al.¬¥s analysis script
# # Emoji understanding
# 
# young$emoji_understanding <- as.factor(young$emoji_understanding)
# levels(young$emoji_understanding)
# 
# young$emoji_understanding <- recode(young$emoji_understanding, "mittelm√§√üig" = "moderate", 
#                                "eher gut" = "rather good",
#                                "gut" = "good",
#                                "sehr gut" = "very good")
# 
# percentages <- young %>%
#   group_by(emoji_understanding) %>% 
#   summarise(count=n())%>% 
#   mutate(percentage=count/sum(count))
# 
# percentages <- within(percentages,
#                       emoji_understanding <- factor(emoji_understanding,
#                                                levels= c("moderate", "rather good", "good", "very good")))
# 
# percentages_plot <- percentages %>%
#   ggplot(aes(x=emoji_understanding, y=percentage, fill=as.factor(emoji_understanding))) +
#   geom_bar(stat="identity", width=0.5)+
#   labs(x = "Understanding of emojis") +
#   ylab("")+
#   theme( axis.title=element_text(size="18", vjust=-0.6), 
#          axis.title.x = element_text(margin = unit(c(0.5, 2, 0, 0), "cm")),
#          axis.title.y = element_text(margin = unit(c(2, 0.5, 0, 0), "cm")), 
#          axis.text=element_text(size="13"),
#          legend.text=element_text(size="18")) +
#   scale_fill_manual(values = c("#D1DF9F","#BBCE70", "#A4BE40", "#8DAE10") ) +
#   theme(legend.position="none")
# 
# percentages_plot

```

Bring in gender:

```{r}

emoji_understanding_gender <- data |>
  group_by(gender) |>
  count(gender, emoji_understanding) |> 
  mutate(absolute = n/24, #24 rows per participant/submission_id (calculate more elegantly?)
         total = sum(absolute), 
         percentage = (absolute/total) * 100) |> 
  mutate(emoji_understanding = factor(emoji_understanding, levels = c("mittelm√§√üig", "eher gut", "gut", "sehr gut")))

```

Plot absolute frequencies: 

```{r}

ggplot(emoji_understanding_gender, aes(x = emoji_understanding, y = absolute, fill = gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Emoji Understanding by Gender",
       x = "self-reported emoji understanding")

```

Plot relative frequencies: 

```{r}

ggplot(emoji_understanding_gender, aes(x = emoji_understanding, y = percentage, fill = gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Emoji Understanding by Gender",
       x = "self-reported emoji understanding")

```

```{r boxplot use x age}
age_data <- data |> 
  group_by(submission_id) |> 
  count(emoji_use, age) |> 
  mutate(emoji_use = factor(emoji_use, levels = c("nie", "selten", "gelegentlich", "oft", "in fast jeder Nachricht")))

age_data |> 
  ggplot(aes (x = emoji_use, y = age, fill = emoji_use)) + 
  geom_boxplot() +
  geom_jitter(color="black", size=0.8, alpha=0.9)+
  theme (legend.position="none")
```

::: {.callout-tip}
#### Quiz time! {.unnumbered}

1\) Test question?

```{r echo=FALSE, results="asis"}

check_question("D", options = c("A", "B", "C", "D", "E"), type = "radio", 
random_answer_order = TRUE,
button_label = "Check answer", q_id = 4,
right = "Test right!",
wrong = "Test incorrect.")

```
:::

## Inserting emojis in R

üòÅ

## Conclusion

## References
